(()=>{"use strict";function e(e){return e&&e.nodeType&&1===e.nodeType}function t(e,t){if(!e)return;let n=0;if(e.forEach){const r=e.length;if(r<=0)return;for(;n<r&&!t(e[n],n);)n++}else{const r=Object.keys(e),o=r.length;if(o<=0)return;for(;n<o&&!t(e[r[n]],r[n]);)n++}}function n(t,n,r){if(!e(t))return void n();const o=new MutationObserver((function(e){if(!e||e.length<1)return;const t=e[0].addedNodes;!t||t.length<1||n(t)}));return o.observe(t,r||{childList:!0,subtree:!0}),()=>{o.disconnect()}}window.definePlugin("math",(function(r,o){const i=o.data("container");if(!e(i))return;const c=i.querySelector(".pages");if(!e(c))return;c.querySelector(".tex, .katex, .katex-display")&&setTimeout((()=>{let e=!1;const t=document.head.querySelectorAll("link");if(t.length>0&&t.forEach((t=>{/\/katex/.test(t.href.replace("//",""))&&(!e&&(e=!0),i.appendChild(t.cloneNode()))})),!e){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css",i.appendChild(e)}}),1e3),c.querySelector(".ztext-math, .MathJax_SVG, .MJX_Assistive_MathML")&&setTimeout((()=>{let e="";const n=document.styleSheets;if(n.length>0&&t(n,(n=>{let r;try{r=n.rules||n.cssRules}catch{}r&&t(r,(t=>{const n=t.cssText;/mathjax|tex2jax|math/i.test(n)&&(e+=n)}))})),e.length>0){const t=document.createElement("style");t.textContent=e,i.appendChild(t)}}),1e3);let s=[];function l(){s.length<=0||t(s,(e=>{if(!e)return;const t=e._mirrorElement;t&&(e.innerHTML=t.innerHTML)}))}function u(e){setTimeout((()=>{if(!c)return;if(s=Array.from(c.querySelectorAll(".ztext-math")),l(),!e||!e.parentElement)return;const r=e.parentElement,o=r.cloneNode(!0);i.appendChild(o),n(r,(e=>{l(),t(e,(e=>{o.appendChild(e)}))}))}),100)}if(location.href.indexOf("www.zhihu.com")>=0){const r=document.body.querySelector("#MathJax_SVG_glyphs");if(e(r))u(r);else{const r=n(document.body,(n=>{if(!n||n.length<1)return;const o=n[0].addedNodes;if(!o||o.length<0)return;let i;t(o,(t=>{const n=t.querySelector("#MathJax_SVG_glyphs");if(e(n))return i=n,!0})),i&&(r&&r(),u(i))}),{childList:!0,subtree:!0})}}}))})();