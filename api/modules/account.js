(()=>{var e={193:e=>{var t,n,o,r,i,a,s,c,l,p,d,u,h,m,f,g=!1;function v(){if(!g){g=!0;var e=navigator.userAgent,v=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),x=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(u=/\b(iPhone|iP[ao]d)/.exec(e),h=/\b(iP[ao]d)/.exec(e),p=/Android/i.exec(e),m=/FBAN\/\w+;/i.exec(e),f=/Mobile/i.exec(e),d=!!/Win64/.exec(e),v){(t=v[1]?parseFloat(v[1]):v[5]?parseFloat(v[5]):NaN)&&document&&document.documentMode&&(t=document.documentMode);var y=/(?:Trident\/(\d+.\d+))/.exec(e);a=y?parseFloat(y[1])+4:t,n=v[2]?parseFloat(v[2]):NaN,o=v[3]?parseFloat(v[3]):NaN,(r=v[4]?parseFloat(v[4]):NaN)?(v=/(?:Chrome\/(\d+\.\d+))/.exec(e),i=v&&v[1]?parseFloat(v[1]):NaN):i=NaN}else t=n=o=i=r=NaN;if(x){if(x[1]){var b=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);s=!b||parseFloat(b[1].replace("_","."))}else s=!1;c=!!x[2],l=!!x[3]}else s=c=l=!1}}var x={ie:function(){return v()||t},ieCompatibilityMode:function(){return v()||a>t},ie64:function(){return x.ie()&&d},firefox:function(){return v()||n},opera:function(){return v()||o},webkit:function(){return v()||r},safari:function(){return x.webkit()},chrome:function(){return v()||i},windows:function(){return v()||c},osx:function(){return v()||s},linux:function(){return v()||l},iphone:function(){return v()||u},mobile:function(){return v()||u||h||p||f},nativeApp:function(){return v()||m},android:function(){return v()||p},ipad:function(){return v()||h}};e.exports=x},235:(e,t,n)=>{"use strict";var o=n(193),r=n(611);function i(e){var t=0,n=0,o=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),o=10*t,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(o=e.deltaX),(o||r)&&e.deltaMode&&(1==e.deltaMode?(o*=40,r*=40):(o*=800,r*=800)),o&&!t&&(t=o<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:o,pixelY:r}}i.getEventType=function(){return o.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},e.exports=i},611:(e,t,n)=>{"use strict";var o,r=n(830);r.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),e.exports=function(e,t){if(!r.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&o&&"wheel"===e&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}},830:e=>{"use strict";var t=!("undefined"==typeof window||!window.document||!window.document.createElement),n={canUseDOM:t,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:t&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};e.exports=n},876:(e,t,n)=>{e.exports=n(235)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=ReactJsxRuntime,t=React,o=(0,t.createContext)({});function r(){return(0,t.useContext)(o)}function i(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function a(e){return i(e,"String")}function s(e){return e&&e.nodeType&&1===e.nodeType}function c(e){return i(e,"Number")}function l(e){return i(e,"Function")}const p=classNames;var d=n.n(p);const u=Antd;var h=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};function m(t){const{type:n,width:o,children:i,placement:a,onCancel:s,className:c,rootClassName:l}=t,p=h(t,["type","width","children","placement","onCancel","className","rootClassName"]),{app:m}=r();return"toolbar"===n?(0,e.jsx)(u.Drawer,Object.assign({styles:{body:{padding:0}}},p,{mask:!1,width:o,onClose:s,className:c,rootClassName:d()("popup-toolbar",l),placement:m.device.phone?"bottom":a,children:i})):"modal"===n?(0,e.jsx)(u.Modal,Object.assign({},p,{onCancel:s,rootClassName:l,width:m.device.phone?"90%":o,className:d()(c,"popup-modal"),children:i})):(0,e.jsx)(u.Drawer,Object.assign({},p,{onClose:s,className:c,width:m.device.phone?"100%":o,rootClassName:d()("popup-drawer",l),placement:m.device.phone?"bottom":a,children:i}))}var f=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};function g(n){const{id:o,type:i,onCancel:a,onChange:l,onVisible:p,children:d,width:u=378,placement:h="right",destoryWithRender:g=!0}=n,v=f(n,["id","type","onCancel","onChange","onVisible","children","width","placement","destoryWithRender"]),x=(0,t.useRef)("0px"),y=(0,t.useRef)(null),{me:b,app:w,container:C}=r(),[j,S]=(0,t.useState)(!1),[_,R]=(0,t.useState)(8e3);return(0,t.useEffect)((()=>{const e=[];function t(e){if(e){const e=w.field("container");if(s(e)){const t=e.style.getPropertyValue("--offsetright");t&&(x.current=t)}w.fire("display",!0,"0px","offsetright"),C.style.display="none"}else w.fire("display",!0,x.current||"0px","offsetright"),x.current="",C.style.removeProperty("display")}return e.push(w.on("screenshot_change",t)),e.push(w.on("print_change",t)),e.push(w.on(o,((...e)=>{S((t=>{if(l){e.unshift(!t);if(l.apply(w,e))return t}return t||R((e=>{let t=e+10;const n=w.field("zIndex");return c(n)&&(t=n+10),w.field("zIndex",t),t})),p&&p(!t),!t}))}))),e.push(w.on(`${b.id}_enable`,(()=>{if(!w.device.phone&&!i){const e=w.field("container");if(s(e)){const t=e.style.getPropertyValue("--offsetright");t&&w.fire("display",!0,t,`offset${h}`)}}}))),()=>{e.forEach((e=>{e()}))}}),[]),(0,t.useEffect)((()=>{y.current&&clearTimeout(y.current),y.current=setTimeout((()=>{if(j){if(!w.device.phone&&!i){const e=w.field("container");if(s(e)){const t=e.style.getPropertyValue("--offsetright");t&&(x.current=t)}w.fire("display",!0,`${u}px`,`offset${h}`)}}else w.device.phone||i||w.fire("display",!0,x.current||"0px",`offset${h}`);w.fire("toolbar_state",o,j?"active":"inactive")}),500)}),[u,j]),(0,t.useEffect)((()=>w.on("render_leave",(()=>{g&&(p&&p(!1),S(!1))}))),[g]),(0,e.jsx)(m,Object.assign({type:i,open:j,width:u,zIndex:_,onCancel:e=>{p&&p(!1),S(!1),a&&a(e)},placement:h},v,{children:d}))}function v(){const{me:e,app:n,container:o}=r(),[i,a]=(0,t.useState)(n.user),s=(0,t.useRef)(n.user.is_logged_in),c=e=>{const t=[];return["member","premium"].forEach((n=>{e.roles.includes(n)&&t.push(n)})),(t.length>0?n.fetch("expire/get",{query:{roles:t.join(",")},headers:{"X-Circle-App":"reader","X-Circle-Lang":n.lang,"X-Circle-Version":n.version,"X-Circle-Token":`${e.access_token}*&~!${e.uid}`}}):Promise.resolve({member:0,premium:0})).then((t=>(n.fire("user_refresh",Object.assign(Object.assign({},e),t)),Promise.resolve(!0))))};return(0,t.useEffect)((()=>{const e=[];return e.push(n.on("tab_activated",(()=>{n.syncUser().then((()=>{a(Object.assign({},n.user))}))}))),e.push(n.on("user_refresh",(e=>{n.syncUser(e).then((e=>{a(Object.assign({},e))}))}))),()=>{e.forEach((e=>{e()}))}}),[]),(0,t.useEffect)((()=>{if(s.current===i.is_logged_in)return;s.current=i.is_logged_in;const e=i.roles.filter((e=>["member","premium"].includes(e))),t=e.join("_")||"expired";n.field(t)||(n.field(t,!0),n.fire("expired",e.length<=0,(()=>{n.field(t,"destory")})))}),[i.is_logged_in]),{me:e,app:n,user:i,login:e=>n.syncUser(Object.assign(Object.assign({},n.user),{access_token:""})).then((()=>n.fetch("circle/login",{data:e}).then(c))),logout:()=>(n.fire("user_refresh",{uid:i.uid,roles:[],access_token:""}),Promise.resolve(!0)),register:e=>n.syncUser(Object.assign(Object.assign({},n.user),{access_token:""})).then((()=>n.fetch("circle/register",{data:e}).then(c))),container:o,resetPassowrd:e=>n.fetch("circle/password",{data:e}).then(c),updateProfile:e=>n.fetch("circle/profile",{data:e}).then(c)}}const x=dayjs;var y=n.n(x);function b(e){if(a(e))return e;try{return JSON.stringify(e)}catch(t){return e.toString()}}function w(e){const{uri:n,query:o,defaultLimit:i=10}=e,{me:a,app:s,container:c}=r(),[l,p]=(0,t.useState)(1),[d,u]=(0,t.useState)(""),[h,m]=(0,t.useState)(i),[f,g]=(0,t.useState)(!1),[v,x]=(0,t.useState)({total:0,items:[]}),y=()=>{g(!0),s.fetch(n,{query:Object.assign(Object.assign({},o),{limit:h,start:l,search:d})}).then(x).catch((e=>{s.error(e&&e.message?e.message:e)})).finally((()=>{g(!1)}))};return(0,t.useEffect)(y,[b(Object.assign(Object.assign({},o),{limit:h,start:l,search:d}))]),{me:a,app:s,data:v,start:l,limit:h,search:d,loading:f,refetch:y,onPager:(e,t)=>{p(e),m(t)},onSearch:e=>{p(1),u(e)},container:c}}function C(){const e=window.innerHeight-420;return e>950?950:e}function j(){const{app:t,data:n,start:o,limit:r,loading:i,onPager:a,refetch:s}=w({uri:"order/list",query:{order:"create"}});return(0,e.jsxs)("div",{className:"page",children:[(0,e.jsx)(u.Space,{className:"flex",children:(0,e.jsx)(u.Button,{size:"small",type:"primary",onClick:()=>{t.fire("subscribe","member",(()=>{t.fire("subscribe"),s()}))},children:t.i18n(n.total>0?"buy_again":"buy")})}),(0,e.jsx)(u.Table,{loading:i,dataSource:n.items,scroll:{y:C()},locale:{emptyText:(0,e.jsx)(u.Empty,{description:t.i18n("empty"),image:u.Empty.PRESENTED_IMAGE_SIMPLE})},pagination:{size:"small",simple:!0,current:o,pageSize:r,total:n.total,onChange:a,showQuickJumper:!0,position:["bottomCenter"],showSizeChanger:n.total>r,locale:{page:t.i18n("page"),jump_to:t.i18n("jump"),items_per_page:t.i18n("page")}},columns:[{title:t.i18n("role"),dataIndex:"rid",render:e=>function(e,t){return t.i18n(e)||e}(e,t)},{width:"20%",title:t.i18n("expire"),dataIndex:"expire",render:e=>function(e,t){const n=c(e)?e:parseFloat(e);return n>0?`${n}${t.i18n("month")}`:t.i18n("forever")}(e,t)},{width:"20%",title:t.i18n("status"),dataIndex:"status",render:n=>{const o=function(e,t){switch(e){case"done":return{label:t.i18n("order_done"),color:"success"};case"cancel":return{label:t.i18n("order_cancel"),color:"error"};default:return{label:t.i18n("order_wait"),color:"default"}}}(n,t);return(0,e.jsx)(u.Tag,{color:o.color,children:o.label})}},{width:"25%",title:t.i18n("time"),dataIndex:"create",render:e=>y()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}]})]})}function S(){const{user:t}=v(),{app:n,data:o,start:r,limit:i,loading:a,onPager:s,refetch:c}=w({uri:"donate/list",query:{uid:t.uid,order:"create"}});return(0,e.jsxs)("div",{className:"page",children:[(0,e.jsx)(u.Space,{className:"flex",children:(0,e.jsx)(u.Button,{size:"small",type:"primary",onClick:()=>{n.fire("donate","tips",(()=>{n.fire("donate"),c()}))},children:n.i18n(o.total>0?"donate_again":"donate")})}),(0,e.jsx)(u.Table,{loading:a,dataSource:o.items,scroll:{y:C()},locale:{emptyText:(0,e.jsx)(u.Empty,{description:n.i18n("empty"),image:u.Empty.PRESENTED_IMAGE_SIMPLE})},pagination:{size:"small",simple:!0,current:r,pageSize:i,total:o.total,onChange:s,showQuickJumper:!0,position:["bottomCenter"],showSizeChanger:o.total>i,locale:{page:n.i18n("page"),jump_to:n.i18n("jump"),items_per_page:n.i18n("page")}},columns:[{title:n.i18n("price"),dataIndex:"price",render:e=>`${e||"--"}${n.i18n("unit")}`},{width:"25%",title:n.i18n("time"),dataIndex:"create",render:e=>y()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}]})]})}function _(t){const{loading:n}=t,{app:o}=r();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(u.Form.Item,{hidden:!0,name:"id",children:(0,e.jsx)(u.Input,{})}),(0,e.jsx)(u.Form.Item,{name:"desc",rules:[{required:!0}],children:(0,e.jsx)(u.Input.TextArea,{rows:5,showCount:!0,maxLength:300,autoComplete:"off",placeholder:o.i18n("desc")})}),(0,e.jsx)(u.Form.Item,{children:(0,e.jsx)(u.Button,{block:!0,type:"primary",htmlType:"submit",loading:n,children:o.i18n("ok")})})]})}function R(n){const{value:o,password:r,defaultValue:i,onChange:a,focusOnEnter:s,...c}=n,l=(0,t.useRef)(null),p=(0,t.useRef)(null),[d,h]=(0,t.useState)(o||i),m=e=>{h(e.target.value),l.current&&(clearTimeout(l.current),l.current=null),l.current=setTimeout((()=>{a&&a(e.target.value)}),600)};return(0,t.useEffect)((()=>{s&&p&&p.current&&setTimeout((()=>{p.current&&p.current.focus&&p.current.focus()}),1e3)}),[s]),r?(0,e.jsx)(u.Input.Password,{...c,ref:p,value:d,onChange:m}):(0,e.jsx)(u.Input,{...c,ref:p,value:d,onChange:m})}function z(n){const{title:o,overflowClass:r,children:i,...a}=n,s=(0,t.useRef)(null),[c,l]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{if(!s||!s.current)return;const e=s.current;e.scrollHeight>e.clientHeight&&l(!0)}),[]),r?(0,e.jsx)(u.Tooltip,{title:c?o:null,...a,children:(0,e.jsx)("span",{title:o,ref:s,className:r,children:i})}):(0,e.jsx)(u.Tooltip,{title:o,...a,children:i})}const E=AntDesignIcons;function P(){const{user:n}=v(),[o]=u.Form.useForm(),[r,i]=(0,t.useState)(null),[a,s]=(0,t.useState)(!1),{app:c,data:l,start:p,limit:d,search:h,loading:m,onPager:f,onSearch:g,refetch:x}=w({uri:"feedback/list",query:{uid:n.uid,order:"create"}}),b=e=>{s(!0),c.fetch("feedback/update",{data:e}).then((()=>{i(null),x()})).catch((e=>{c.error(e&&e.message?e.message:e)})).finally((()=>{s(!1)}))};return(0,t.useEffect)((()=>{r?o.setFieldsValue(r):o.resetFields()}),[r]),(0,e.jsxs)("div",{className:"page",children:[(0,e.jsxs)(u.Space,{className:"flex",children:[(0,e.jsx)(u.Button,{size:"small",type:"primary",onClick:()=>{c.fire("feedback","report",(()=>{c.fire("feedback"),x()}))},children:c.i18n(l.total>0?"feedback_again":"feedback")}),(0,e.jsx)(u.Modal,{footer:null,open:!!r,onCancel:()=>{i(null)},title:c.i18n("action"),okButtonProps:{autoFocus:!0,htmlType:"submit"},modalRender:t=>(0,e.jsx)(u.Form,{form:o,name:"feedback",onFinish:b,children:t}),children:(0,e.jsx)(_,{loading:a})}),(0,e.jsx)(R,{size:"small",value:h,onChange:g,style:{width:240},placeholder:c.i18n("search_placeholder")})]}),(0,e.jsx)(u.Table,{loading:m,dataSource:l.items,scroll:{y:C()},locale:{emptyText:(0,e.jsx)(u.Empty,{description:c.i18n("empty"),image:u.Empty.PRESENTED_IMAGE_SIMPLE})},pagination:{size:"small",simple:!0,current:p,pageSize:d,total:l.total,onChange:f,showQuickJumper:!0,position:["bottomCenter"],showSizeChanger:l.total>d,locale:{page:c.i18n("page"),jump_to:c.i18n("jump"),items_per_page:c.i18n("page")}},columns:[{title:c.i18n("desc"),dataIndex:"desc",render:t=>(0,e.jsx)(z,{title:t,overflowClass:"table-cell",children:t})},{width:"20%",title:c.i18n("status"),dataIndex:"status",render:(t,n)=>{const o=function(e,t){switch(e){case"resolve":return{label:t.i18n("resolve"),color:"cyan"};case"rejected":return{label:t.i18n("rejected"),color:"warning"};case"progress":return{label:t.i18n("progress"),color:"processing"};case"done":return{label:t.i18n("done"),color:"success"};case"release":return{label:t.i18n("release"),color:"purple"};case"duplicate":return{label:t.i18n("duplicate"),color:"volcano"};case"reproduce":return{label:t.i18n("reproduce"),color:"error"};default:return{label:t.i18n("pending"),color:"default"}}}(t,c);return n.reply?(0,e.jsx)(u.Tooltip,{title:n.reply,children:(0,e.jsx)(u.Tag,{color:o.color,children:(0,e.jsxs)(u.Space,{size:3,children:[(0,e.jsx)("span",{children:o.label}),(0,e.jsx)(E.QuestionCircleOutlined,{})]})})}):(0,e.jsx)(u.Tag,{color:o.color,children:o.label})}},{width:"25%",title:c.i18n("time"),dataIndex:"create",render:e=>y()(1e3*e).format("YYYY-MM-DD HH:mm:ss")},{width:"100px",align:"right",dataIndex:"id",title:c.i18n("action"),render:(t,n)=>"resolve"!==n.status?"--":(0,e.jsx)(u.Button,{size:"small",onClick:()=>i(n),children:c.i18n("fill")})}]})]})}function O(){const[n]=u.Form.useForm(),{me:o,app:r,login:i}=v(),[a,s]=(0,t.useState)(!1);return(0,e.jsxs)(u.Form,{name:"login",form:n,onFinish:e=>{s(!0),i(e).then((()=>{n.resetFields(),r.success("login_success");const e=r.data(o.id);l(e)?(r.data(o.id,"destory"),e()):setTimeout((()=>{r.fire(`${o.id}_route`,"profile")}),1e3)})).catch((e=>{r.error(e&&e.message?e.message:e)})).finally((()=>{s(!1)}))},className:"form-wrapper",children:[(0,e.jsx)(u.Form.Item,{name:"mail",rules:[{required:!0,type:"email",message:r.i18n("mail_placeholder")}],children:(0,e.jsx)(u.Input,{autoComplete:"off",placeholder:r.i18n("mail")})}),(0,e.jsx)(u.Form.Item,{name:"pass",rules:[{required:!0,message:r.i18n("pass_placeholder")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")}],children:(0,e.jsx)(u.Input.Password,{placeholder:r.i18n("pass"),autoComplete:"off"})}),(0,e.jsx)(u.Form.Item,{children:(0,e.jsx)(u.Button,{block:!0,type:"primary",htmlType:"submit",loading:a,children:r.i18n("login")})})]})}var D=function(e,t){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},D(e,t)};function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var I=function(){return I=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},I.apply(this,arguments)};function F(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function k(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var T=n(876),N=n.n(T);function A(e,t,n,o,r){void 0===r&&(r=0);var i=q(t.width,t.height,r),a=i.width,s=i.height;return{x:W(e.x,a,n.width,o),y:W(e.y,s,n.height,o)}}function W(e,t,n,o){var r=t*o/2-n/2;return V(e,-r,r)}function L(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function $(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function U(e,t){return Math.min(e,Math.max(0,t))}function Z(e,t){return t}function H(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function q(e,t,n){var o=n*Math.PI/180;return{width:Math.abs(Math.cos(o)*e)+Math.abs(Math.sin(o)*t),height:Math.abs(Math.sin(o)*e)+Math.abs(Math.cos(o)*t)}}function V(e,t,n){return Math.min(Math.max(e,t),n)}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return"string"==typeof e&&e.length>0})).join(" ").trim()}var B=function(e){function n(){var o=null!==e&&e.apply(this,arguments)||this;return o.cropperRef=t.createRef(),o.imageRef=t.createRef(),o.videoRef=t.createRef(),o.containerPosition={x:0,y:0},o.containerRef=null,o.styleRef=null,o.containerRect=null,o.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},o.dragStartPosition={x:0,y:0},o.dragStartCrop={x:0,y:0},o.gestureZoomStart=0,o.gestureRotationStart=0,o.isTouching=!1,o.lastPinchDistance=0,o.lastPinchRotation=0,o.rafDragTimeout=null,o.rafPinchTimeout=null,o.wheelTimer=null,o.currentDoc="undefined"!=typeof document?document:null,o.currentWindow="undefined"!=typeof window?window:null,o.resizeObserver=null,o.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},o.initResizeObserver=function(){if(void 0!==window.ResizeObserver&&o.containerRef){var e=!0;o.resizeObserver=new window.ResizeObserver((function(t){e?e=!1:o.computeSizes()})),o.resizeObserver.observe(o.containerRef)}},o.preventZoomSafari=function(e){return e.preventDefault()},o.cleanEvents=function(){o.currentDoc&&(o.currentDoc.removeEventListener("mousemove",o.onMouseMove),o.currentDoc.removeEventListener("mouseup",o.onDragStopped),o.currentDoc.removeEventListener("touchmove",o.onTouchMove),o.currentDoc.removeEventListener("touchend",o.onDragStopped),o.currentDoc.removeEventListener("gesturemove",o.onGestureMove),o.currentDoc.removeEventListener("gestureend",o.onGestureEnd),o.currentDoc.removeEventListener("scroll",o.onScroll))},o.clearScrollEvent=function(){o.containerRef&&o.containerRef.removeEventListener("wheel",o.onWheel),o.wheelTimer&&clearTimeout(o.wheelTimer)},o.onMediaLoad=function(){var e=o.computeSizes();e&&(o.emitCropData(),o.setInitialCrop(e)),o.props.onMediaLoaded&&o.props.onMediaLoaded(o.mediaSize)},o.setInitialCrop=function(e){if(o.props.initialCroppedAreaPercentages){var t=function(e,t,n,o,r,i){var a=q(t.width,t.height,n),s=V(o.width/a.width*(100/e.width),r,i);return{crop:{x:s*a.width/2-o.width/2-a.width*s*(e.x/100),y:s*a.height/2-o.height/2-a.height*s*(e.y/100)},zoom:s}}(o.props.initialCroppedAreaPercentages,o.mediaSize,o.props.rotation,e,o.props.minZoom,o.props.maxZoom),n=t.crop,r=t.zoom;o.props.onCropChange(n),o.props.onZoomChange&&o.props.onZoomChange(r)}else if(o.props.initialCroppedAreaPixels){var i=function(e,t,n,o,r,i){void 0===n&&(n=0);var a=q(t.naturalWidth,t.naturalHeight,n),s=V(function(e,t,n){var o=function(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}(t);return n.height>n.width?n.height/(e.height*o):n.width/(e.width*o)}(e,t,o),r,i),c=o.height>o.width?o.height/e.height:o.width/e.width;return{crop:{x:((a.width-e.width)/2-e.x)*c,y:((a.height-e.height)/2-e.y)*c},zoom:s}}(o.props.initialCroppedAreaPixels,o.mediaSize,o.props.rotation,e,o.props.minZoom,o.props.maxZoom);n=i.crop,r=i.zoom;o.props.onCropChange(n),o.props.onZoomChange&&o.props.onZoomChange(r)}},o.computeSizes=function(){var e,t,n,r,i,a,s=o.imageRef.current||o.videoRef.current;if(s&&o.containerRef){o.containerRect=o.containerRef.getBoundingClientRect(),o.saveContainerPosition();var c=o.containerRect.width/o.containerRect.height,l=(null===(e=o.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=o.videoRef.current)||void 0===t?void 0:t.videoWidth)||0,p=(null===(n=o.imageRef.current)||void 0===n?void 0:n.naturalHeight)||(null===(r=o.videoRef.current)||void 0===r?void 0:r.videoHeight)||0,d=l/p,u=void 0;if(s.offsetWidth<l||s.offsetHeight<p)switch(o.state.mediaObjectFit){default:case"contain":u=c>d?{width:o.containerRect.height*d,height:o.containerRect.height}:{width:o.containerRect.width,height:o.containerRect.width/d};break;case"horizontal-cover":u={width:o.containerRect.width,height:o.containerRect.width/d};break;case"vertical-cover":u={width:o.containerRect.height*d,height:o.containerRect.height}}else u={width:s.offsetWidth,height:s.offsetHeight};o.mediaSize=I(I({},u),{naturalWidth:l,naturalHeight:p}),o.props.setMediaSize&&o.props.setMediaSize(o.mediaSize);var h=o.props.cropSize?o.props.cropSize:function(e,t,n,o,r,i){void 0===i&&(i=0);var a=q(e,t,i),s=a.width,c=a.height,l=Math.min(s,n),p=Math.min(c,o);return l>p*r?{width:p*r,height:p}:{width:l,height:l/r}}(o.mediaSize.width,o.mediaSize.height,o.containerRect.width,o.containerRect.height,o.props.aspect,o.props.rotation);return(null===(i=o.state.cropSize)||void 0===i?void 0:i.height)===h.height&&(null===(a=o.state.cropSize)||void 0===a?void 0:a.width)===h.width||o.props.onCropSizeChange&&o.props.onCropSizeChange(h),o.setState({cropSize:h},o.recomputeCropPosition),o.props.setCropSize&&o.props.setCropSize(h),h}},o.saveContainerPosition=function(){if(o.containerRef){var e=o.containerRef.getBoundingClientRect();o.containerPosition={x:e.left,y:e.top}}},o.onMouseDown=function(e){o.currentDoc&&(e.preventDefault(),o.currentDoc.addEventListener("mousemove",o.onMouseMove),o.currentDoc.addEventListener("mouseup",o.onDragStopped),o.saveContainerPosition(),o.onDragStart(n.getMousePoint(e)))},o.onMouseMove=function(e){return o.onDrag(n.getMousePoint(e))},o.onScroll=function(e){o.currentDoc&&(e.preventDefault(),o.saveContainerPosition())},o.onTouchStart=function(e){o.currentDoc&&(o.isTouching=!0,o.props.onTouchRequest&&!o.props.onTouchRequest(e)||(o.currentDoc.addEventListener("touchmove",o.onTouchMove,{passive:!1}),o.currentDoc.addEventListener("touchend",o.onDragStopped),o.saveContainerPosition(),2===e.touches.length?o.onPinchStart(e):1===e.touches.length&&o.onDragStart(n.getTouchPoint(e.touches[0]))))},o.onTouchMove=function(e){e.preventDefault(),2===e.touches.length?o.onPinchMove(e):1===e.touches.length&&o.onDrag(n.getTouchPoint(e.touches[0]))},o.onGestureStart=function(e){o.currentDoc&&(e.preventDefault(),o.currentDoc.addEventListener("gesturechange",o.onGestureMove),o.currentDoc.addEventListener("gestureend",o.onGestureEnd),o.gestureZoomStart=o.props.zoom,o.gestureRotationStart=o.props.rotation)},o.onGestureMove=function(e){if(e.preventDefault(),!o.isTouching){var t=n.getMousePoint(e),r=o.gestureZoomStart-1+e.scale;if(o.setNewZoom(r,t,{shouldUpdatePosition:!0}),o.props.onRotationChange){var i=o.gestureRotationStart+e.rotation;o.props.onRotationChange(i)}}},o.onGestureEnd=function(e){o.cleanEvents()},o.onDragStart=function(e){var t,n,r=e.x,i=e.y;o.dragStartPosition={x:r,y:i},o.dragStartCrop=I({},o.props.crop),null===(n=(t=o.props).onInteractionStart)||void 0===n||n.call(t)},o.onDrag=function(e){var t=e.x,n=e.y;o.currentWindow&&(o.rafDragTimeout&&o.currentWindow.cancelAnimationFrame(o.rafDragTimeout),o.rafDragTimeout=o.currentWindow.requestAnimationFrame((function(){if(o.state.cropSize&&void 0!==t&&void 0!==n){var e=t-o.dragStartPosition.x,r=n-o.dragStartPosition.y,i={x:o.dragStartCrop.x+e,y:o.dragStartCrop.y+r},a=o.props.restrictPosition?A(i,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):i;o.props.onCropChange(a)}})))},o.onDragStopped=function(){var e,t;o.isTouching=!1,o.cleanEvents(),o.emitCropData(),null===(t=(e=o.props).onInteractionEnd)||void 0===t||t.call(e)},o.onWheel=function(e){if(o.currentWindow&&(!o.props.onWheelRequest||o.props.onWheelRequest(e))){e.preventDefault();var t=n.getMousePoint(e),r=N()(e).pixelY,i=o.props.zoom-r*o.props.zoomSpeed/200;o.setNewZoom(i,t,{shouldUpdatePosition:!0}),o.state.hasWheelJustStarted||o.setState({hasWheelJustStarted:!0},(function(){var e,t;return null===(t=(e=o.props).onInteractionStart)||void 0===t?void 0:t.call(e)})),o.wheelTimer&&clearTimeout(o.wheelTimer),o.wheelTimer=o.currentWindow.setTimeout((function(){return o.setState({hasWheelJustStarted:!1},(function(){var e,t;return null===(t=(e=o.props).onInteractionEnd)||void 0===t?void 0:t.call(e)}))}),250)}},o.getPointOnContainer=function(e,t){var n=e.x,r=e.y;if(!o.containerRect)throw new Error("The Cropper is not mounted");return{x:o.containerRect.width/2-(n-t.x),y:o.containerRect.height/2-(r-t.y)}},o.getPointOnMedia=function(e){var t=e.x,n=e.y,r=o.props,i=r.crop,a=r.zoom;return{x:(t+i.x)/a,y:(n+i.y)/a}},o.setNewZoom=function(e,t,n){var r=(void 0===n?{}:n).shouldUpdatePosition,i=void 0===r||r;if(o.state.cropSize&&o.props.onZoomChange){var a=V(e,o.props.minZoom,o.props.maxZoom);if(i){var s=o.getPointOnContainer(t,o.containerPosition),c=o.getPointOnMedia(s),l={x:c.x*a-s.x,y:c.y*a-s.y},p=o.props.restrictPosition?A(l,o.mediaSize,o.state.cropSize,a,o.props.rotation):l;o.props.onCropChange(p)}o.props.onZoomChange(a)}},o.getCropData=function(){return o.state.cropSize?function(e,t,n,o,r,i,a){void 0===i&&(i=0),void 0===a&&(a=!0);var s=a?U:Z,c=q(t.width,t.height,i),l=q(t.naturalWidth,t.naturalHeight,i),p={x:s(100,((c.width-n.width/r)/2-e.x/r)/c.width*100),y:s(100,((c.height-n.height/r)/2-e.y/r)/c.height*100),width:s(100,n.width/c.width*100/r),height:s(100,n.height/c.height*100/r)},d=Math.round(s(l.width,p.width*l.width/100)),u=Math.round(s(l.height,p.height*l.height/100)),h=l.width>=l.height*o?{width:Math.round(u*o),height:u}:{width:d,height:Math.round(d/o)};return{croppedAreaPercentages:p,croppedAreaPixels:I(I({},h),{x:Math.round(s(l.width-h.width,p.x*l.width/100)),y:Math.round(s(l.height-h.height,p.y*l.height/100))})}}(o.props.restrictPosition?A(o.props.crop,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):o.props.crop,o.mediaSize,o.state.cropSize,o.getAspect(),o.props.zoom,o.props.rotation,o.props.restrictPosition):null},o.emitCropData=function(){var e=o.getCropData();if(e){var t=e.croppedAreaPercentages,n=e.croppedAreaPixels;o.props.onCropComplete&&o.props.onCropComplete(t,n),o.props.onCropAreaChange&&o.props.onCropAreaChange(t,n)}},o.emitCropAreaChange=function(){var e=o.getCropData();if(e){var t=e.croppedAreaPercentages,n=e.croppedAreaPixels;o.props.onCropAreaChange&&o.props.onCropAreaChange(t,n)}},o.recomputeCropPosition=function(){if(o.state.cropSize){var e=o.props.restrictPosition?A(o.props.crop,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):o.props.crop;o.props.onCropChange(e),o.emitCropData()}},o.onKeyDown=function(e){var t,n,r=o.props,i=r.crop,a=r.onCropChange,s=r.keyboardStep,c=r.zoom,l=r.rotation,p=s;if(o.state.cropSize){e.shiftKey&&(p*=.2);var d=I({},i);switch(e.key){case"ArrowUp":d.y-=p,e.preventDefault();break;case"ArrowDown":d.y+=p,e.preventDefault();break;case"ArrowLeft":d.x-=p,e.preventDefault();break;case"ArrowRight":d.x+=p,e.preventDefault();break;default:return}o.props.restrictPosition&&(d=A(d,o.mediaSize,o.state.cropSize,c,l)),e.repeat||null===(n=(t=o.props).onInteractionStart)||void 0===n||n.call(t),a(d)}},o.onKeyUp=function(e){var t,n;switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":e.preventDefault();break;default:return}o.emitCropData(),null===(n=(t=o.props).onInteractionEnd)||void 0===n||n.call(t)},o}return M(n,e),n.prototype.componentDidMount=function(){this.currentDoc&&this.currentWindow&&(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),void 0===window.ResizeObserver&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=".reactEasyCrop_Container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  user-select: none;\n  touch-action: none;\n  cursor: move;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.reactEasyCrop_Image,\n.reactEasyCrop_Video {\n  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */\n}\n\n.reactEasyCrop_Contain {\n  max-width: 100%;\n  max-height: 100%;\n  margin: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactEasyCrop_Cover_Horizontal {\n  width: 100%;\n  height: auto;\n}\n.reactEasyCrop_Cover_Vertical {\n  width: auto;\n  height: 100%;\n}\n\n.reactEasyCrop_CropArea {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  box-sizing: border-box;\n  box-shadow: 0 0 0 9999em;\n  color: rgba(0, 0, 0, 0.5);\n  overflow: hidden;\n}\n\n.reactEasyCrop_CropAreaRound {\n  border-radius: 50%;\n}\n\n.reactEasyCrop_CropAreaGrid::before {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 0;\n  bottom: 0;\n  left: 33.33%;\n  right: 33.33%;\n  border-top: 0;\n  border-bottom: 0;\n}\n\n.reactEasyCrop_CropAreaGrid::after {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 33.33%;\n  bottom: 33.33%;\n  left: 0;\n  right: 0;\n  border-left: 0;\n  border-right: 0;\n}\n",this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},n.prototype.componentWillUnmount=function(){var e,t;this.currentDoc&&this.currentWindow&&(void 0===window.ResizeObserver&&this.currentWindow.removeEventListener("resize",this.computeSizes),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&(null===(t=this.styleRef.parentNode)||void 0===t||t.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},n.prototype.componentDidUpdate=function(e){var t,n,o,r,i,a,s,c,l;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect||e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():(null===(t=e.cropSize)||void 0===t?void 0:t.height)!==(null===(n=this.props.cropSize)||void 0===n?void 0:n.height)||(null===(o=e.cropSize)||void 0===o?void 0:o.width)!==(null===(r=this.props.cropSize)||void 0===r?void 0:r.width)?this.computeSizes():(null===(i=e.crop)||void 0===i?void 0:i.x)===(null===(a=this.props.crop)||void 0===a?void 0:a.x)&&(null===(s=e.crop)||void 0===s?void 0:s.y)===(null===(c=this.props.crop)||void 0===c?void 0:c.y)||this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&(null===(l=this.videoRef.current)||void 0===l||l.load());var p=this.getObjectFit();p!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:p},this.computeSizes)},n.prototype.getAspect=function(){var e=this.props,t=e.cropSize,n=e.aspect;return t?t.width/t.height:n},n.prototype.getObjectFit=function(){var e,t,n,o;if("cover"===this.props.objectFit){if((this.imageRef.current||this.videoRef.current)&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var r=this.containerRect.width/this.containerRect.height;return((null===(e=this.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=this.videoRef.current)||void 0===t?void 0:t.videoWidth)||0)/((null===(n=this.imageRef.current)||void 0===n?void 0:n.naturalHeight)||(null===(o=this.videoRef.current)||void 0===o?void 0:o.videoHeight)||0)<r?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},n.prototype.onPinchStart=function(e){var t=n.getTouchPoint(e.touches[0]),o=n.getTouchPoint(e.touches[1]);this.lastPinchDistance=L(t,o),this.lastPinchRotation=$(t,o),this.onDragStart(H(t,o))},n.prototype.onPinchMove=function(e){var t=this;if(this.currentDoc&&this.currentWindow){var o=n.getTouchPoint(e.touches[0]),r=n.getTouchPoint(e.touches[1]),i=H(o,r);this.onDrag(i),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame((function(){var e=L(o,r),n=t.props.zoom*(e/t.lastPinchDistance);t.setNewZoom(n,i,{shouldUpdatePosition:!1}),t.lastPinchDistance=e;var a=$(o,r),s=t.props.rotation+(a-t.lastPinchRotation);t.props.onRotationChange&&t.props.onRotationChange(s),t.lastPinchRotation=a}))}},n.prototype.render=function(){var e,n=this,o=this.props,r=o.image,i=o.video,a=o.mediaProps,s=o.cropperProps,c=o.transform,l=o.crop,p=l.x,d=l.y,u=o.rotation,h=o.zoom,m=o.cropShape,f=o.showGrid,g=o.style,v=g.containerStyle,x=g.cropAreaStyle,y=g.mediaStyle,b=o.classes,w=b.containerClassName,C=b.cropAreaClassName,j=b.mediaClassName,S=null!==(e=this.state.mediaObjectFit)&&void 0!==e?e:this.getObjectFit();return t.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(e){return n.containerRef=e},"data-testid":"container",style:v,className:G("reactEasyCrop_Container",w)},r?t.createElement("img",I({alt:"",className:G("reactEasyCrop_Image","contain"===S&&"reactEasyCrop_Contain","horizontal-cover"===S&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===S&&"reactEasyCrop_Cover_Vertical",j)},a,{src:r,ref:this.imageRef,style:I(I({},y),{transform:c||"translate(".concat(p,"px, ").concat(d,"px) rotate(").concat(u,"deg) scale(").concat(h,")")}),onLoad:this.onMediaLoad})):i&&t.createElement("video",I({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:G("reactEasyCrop_Video","contain"===S&&"reactEasyCrop_Contain","horizontal-cover"===S&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===S&&"reactEasyCrop_Cover_Vertical",j)},a,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:I(I({},y),{transform:c||"translate(".concat(p,"px, ").concat(d,"px) rotate(").concat(u,"deg) scale(").concat(h,")")}),controls:!1}),(Array.isArray(i)?i:[{src:i}]).map((function(e){return t.createElement("source",I({key:e.src},e))}))),this.state.cropSize&&t.createElement("div",I({ref:this.cropperRef,style:I(I({},x),{width:this.state.cropSize.width,height:this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:G("reactEasyCrop_CropArea","round"===m&&"reactEasyCrop_CropAreaRound",f&&"reactEasyCrop_CropAreaGrid",C)},s)))},n.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:3,minZoom:1,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:1},n.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},n.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},n}(t.Component);const Y="img-crop",X=.1,J=.01,K=(0,t.forwardRef)(((n,o)=>{const{cropperRef:r,zoomSlider:i,rotationSlider:a,aspectSlider:s,showReset:c,resetBtnText:l,modalImage:p,aspect:d,minZoom:h,maxZoom:m,minAspect:f,maxAspect:g,cropShape:v,showGrid:x,cropperProps:y}=n,[b,w]=(0,t.useState)(1),[C,j]=(0,t.useState)(0),[S,_]=(0,t.useState)(d),R=1!==b||0!==C||S!==d,z=()=>{w(1),j(0),_(d)},[E,P]=(0,t.useState)({x:0,y:0}),O=(0,t.useRef)({width:0,height:0,x:0,y:0}),D=(0,t.useCallback)(((e,t)=>{O.current=t}),[]);(0,t.useImperativeHandle)(o,(()=>({rotation:C,cropPixelsRef:O,onReset:z})));const M="[display:flex] [align-items:center] [width:60%] [margin-inline:auto]",I="[display:flex] [align-items:center] [justify-content:center] [height:32px] [width:32px] [background:transparent] [border:0] [font-family:inherit] [font-size:18px] [cursor:pointer] disabled:[opacity:20%] disabled:[cursor:default]",F="[flex:1]";return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(B,Object.assign({},y,{ref:r,image:p,crop:E,zoom:b,rotation:C,aspect:S,minZoom:h,maxZoom:m,zoomWithScroll:i,cropShape:v,showGrid:x,onCropChange:P,onZoomChange:w,onRotationChange:j,onCropComplete:D,classes:{containerClassName:`${Y}-container ![position:relative] [width:100%] [height:40vh] [&~section:first-of-type]:[margin-top:16px] [&~section:last-of-type]:[margin-bottom:16px]`,mediaClassName:`${Y}-media`}})),i&&(0,e.jsxs)("section",{className:`${Y}-control ${Y}-control-zoom ${M}`,children:[(0,e.jsx)("button",{className:I,onClick:()=>w(+(b-X).toFixed(1)),disabled:b-X<h,children:"－"}),(0,e.jsx)(u.Slider,{className:F,min:h,max:m,step:X,value:b,onChange:w}),(0,e.jsx)("button",{className:I,onClick:()=>w(+(b+X).toFixed(1)),disabled:b+X>m,children:"＋"})]}),a&&(0,e.jsxs)("section",{className:`${Y}-control ${Y}-control-rotation ${M}`,children:[(0,e.jsx)("button",{className:`${I} [font-size:16px]`,onClick:()=>j(C-1),disabled:-180===C,children:"↺"}),(0,e.jsx)(u.Slider,{className:F,min:-180,max:180,step:1,value:C,onChange:j}),(0,e.jsx)("button",{className:`${I} [font-size:16px]`,onClick:()=>j(C+1),disabled:180===C,children:"↻"})]}),s&&(0,e.jsxs)("section",{className:`${Y}-control ${Y}-control-aspect ${M}`,children:[(0,e.jsx)("button",{className:I,onClick:()=>_(+(S-J).toFixed(2)),disabled:S-J<f,children:"↕"}),(0,e.jsx)(u.Slider,{className:F,min:f,max:g,step:J,value:S,onChange:_}),(0,e.jsx)("button",{className:I,onClick:()=>_(+(S+J).toFixed(2)),disabled:S+J>g,children:"↔"})]}),c&&(i||a||s)&&(0,e.jsx)(u.Button,{className:"[bottom:20px] [position:absolute]",style:R?{}:{opacity:.3,pointerEvents:"none"},onClick:z,children:l})]})}));var Q=(0,t.memo)(K);!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".\\[align-items\\:center\\]{align-items:center}.\\[background\\:transparent\\]{background:transparent}.\\[border\\:0\\]{border:0}.\\[bottom\\:20px\\]{bottom:20px}.\\[cursor\\:pointer\\]{cursor:pointer}.\\[display\\:flex\\]{display:flex}.\\[flex\\:1\\]{flex:1}.\\[font-family\\:inherit\\]{font-family:inherit}.\\[font-size\\:16px\\]{font-size:16px}.\\[font-size\\:18px\\]{font-size:18px}.\\[height\\:32px\\]{height:32px}.\\[height\\:40vh\\]{height:40vh}.\\[justify-content\\:center\\]{justify-content:center}.\\[margin-inline\\:auto\\]{margin-inline:auto}.\\[position\\:absolute\\]{position:absolute}.\\!\\[position\\:relative\\]{position:relative!important}.\\[width\\:100\\%\\]{width:100%}.\\[width\\:32px\\]{width:32px}.\\[width\\:60\\%\\]{width:60%}.disabled\\:\\[cursor\\:default\\]:disabled{cursor:default}.disabled\\:\\[opacity\\:20\\%\\]:disabled{opacity:20%}.\\[\\&\\~section\\:first-of-type\\]\\:\\[margin-top\\:16px\\]~section:first-of-type{margin-top:16px}.\\[\\&\\~section\\:last-of-type\\]\\:\\[margin-bottom\\:16px\\]~section:last-of-type{margin-bottom:16px}",{insertAt:"top"});const ee=(0,t.forwardRef)(((n,o)=>{const{quality:r=.4,fillColor:i="white",zoomSlider:a=!0,rotationSlider:s=!1,aspectSlider:c=!1,showReset:l=!1,resetText:p,aspect:d=1,minZoom:h=1,maxZoom:m=3,minAspect:f=.5,maxAspect:g=2,cropShape:v="rect",showGrid:x=!1,cropperProps:y,modalClassName:b,modalTitle:w,modalWidth:C,modalOk:j,modalCancel:S,onModalOk:_,onModalCancel:R,modalProps:z,beforeCrop:E,children:P}=n,O=(0,t.useRef)({});O.current.onModalOk=_,O.current.onModalCancel=R,O.current.beforeCrop=E;const D=(0,t.useRef)(null),M=(0,t.useCallback)((e=>{var t;const n=document.createElement("canvas"),o=n.getContext("2d"),r=((null===(t=null==e?void 0:e.getRootNode)||void 0===t?void 0:t.call(e))||document).querySelector(`.${Y}-media`),{width:a,height:c,x:l,y:p}=D.current.cropPixelsRef.current;if(s&&0!==D.current.rotation){const{naturalWidth:e,naturalHeight:t}=r,s=D.current.rotation*(Math.PI/180),d=Math.abs(Math.sin(s)),u=Math.abs(Math.cos(s)),h=e*u+t*d,m=t*u+e*d;n.width=h,n.height=m,o.fillStyle=i,o.fillRect(0,0,h,m);const f=h/2,g=m/2;o.translate(f,g),o.rotate(s),o.translate(-f,-g);const v=(h-e)/2,x=(m-t)/2;o.drawImage(r,0,0,e,t,v,x,e,t);const y=o.getImageData(0,0,h,m);n.width=a,n.height=c,o.putImageData(y,-l,-p)}else n.width=a,n.height=c,o.fillStyle=i,o.fillRect(0,0,a,c),o.drawImage(r,l,p,a,c,0,0,a,c);return n}),[i,s]),[I,T]=(0,t.useState)(""),N=(0,t.useRef)(),A=(0,t.useRef)(),W=(0,t.useCallback)((e=>k(void 0,[e],void 0,(function*({beforeUpload:e,file:t,resolve:n,reject:o}){const r=t;if("function"==typeof e)try{const o=yield e(t,[t]);n(!1!==o&&(!0!==o&&o||r))}catch(e){o(e)}else n(r)}))),[]),L=(0,t.useCallback)((e=>(t,n)=>new Promise(((o,i)=>k(void 0,void 0,void 0,(function*(){let a=t;if("function"==typeof O.current.beforeCrop)try{const r=yield O.current.beforeCrop(t,n);if(!1===r)return W({beforeUpload:e,file:t,resolve:o,reject:i});!0!==r&&(a=r||t)}catch(n){return W({beforeUpload:e,file:t,resolve:o,reject:i})}const s=new FileReader;s.addEventListener("load",(()=>{"string"==typeof s.result&&T(s.result)})),s.readAsDataURL(a),N.current=()=>{var e,t;T(""),D.current.onReset();let n=!1;null===(t=(e=O.current).onModalCancel)||void 0===t||t.call(e,(e=>{o(e),n=!0})),n||o(u.Upload.LIST_IGNORE)},A.current=t=>k(void 0,void 0,void 0,(function*(){T(""),D.current.onReset();const n=M(t.target),{type:s,name:c,uid:l}=a;n.toBlob((t=>k(void 0,void 0,void 0,(function*(){const n=new File([t],c,{type:s});Object.assign(n,{uid:l}),W({beforeUpload:e,file:n,resolve:e=>{var t,n;o(e),null===(n=(t=O.current).onModalOk)||void 0===n||n.call(t,e)},reject:e=>{var t,n;i(e),null===(n=(t=O.current).onModalOk)||void 0===n||n.call(t,e)}})}))),s,r)}))}))))),[M,r,W]),$=(0,t.useCallback)((e=>{const t=Array.isArray(e)?e[0]:e,n=t.props,{beforeUpload:o,accept:r}=n,i=F(n,["beforeUpload","accept"]);return Object.assign(Object.assign({},t),{props:Object.assign(Object.assign({},i),{accept:r||"image/*",beforeUpload:L(o)})})}),[L]),U=(0,t.useMemo)((()=>{const e={};return void 0!==C&&(e.width=C),void 0!==j&&(e.okText=j),void 0!==S&&(e.cancelText=S),e}),[S,j,C]),Z=`${Y}-modal${b?` ${b}`:""}`,H="zh-CN"===("undefined"==typeof window?"":window.navigator.language),q=w||(H?"编辑图片":"Edit image"),V=p||(H?"重置":"Reset");return(0,e.jsxs)(e.Fragment,{children:[$(P),I&&(0,e.jsx)(u.Modal,Object.assign({},z,U,{open:!0,title:q,onCancel:N.current,onOk:A.current,wrapClassName:Z,maskClosable:!1,destroyOnClose:!0,children:(0,e.jsx)(Q,{ref:D,cropperRef:o,zoomSlider:a,rotationSlider:s,aspectSlider:c,showReset:l,resetBtnText:V,modalImage:I,aspect:d,minZoom:h,maxZoom:m,minAspect:f,maxAspect:g,cropShape:v,showGrid:x,cropperProps:y})}))]})}));function te(t){const{onClose:n,onChange:o}=t,{app:i}=r(),a=t=>t.map((t=>{const r=i.path(`/sites/default/files/avatar/man/${t}.png`);return(0,e.jsx)(u.Avatar,{src:r,size:64,shape:"circle",onClick:()=>{o&&o(r),n&&n()}},t)}));return(0,e.jsxs)(u.Space,{direction:"vertical",className:"avatar-man",children:[(0,e.jsx)(u.Space,{children:a([1,2,3])}),(0,e.jsx)(u.Space,{children:a([4,5,6])})]})}function ne(n){const{trigger:o,visible:a,children:s,className:c,onSubmit:p,onOk:h,onCancel:m,width:f=600,...g}=n,{app:v}=r(),[x,y]=(0,t.useState)(!1),b=e=>{y(!1),m&&m(e)};return(0,e.jsxs)(e.Fragment,{children:[o&&l(o)?o((e=>{e.stopPropagation(),e.preventDefault(),y(!0)})):o,(0,e.jsx)(u.Modal,{width:f,onOk:e=>{p&&p(e).then((t=>{i(t,"Boolean")&&t&&b(e)})),h&&h(e)},onCancel:b,okText:v.i18n("ok"),cancelText:v.i18n("cancel"),className:d()("modal",c),open:(w=a,i(w,"Undefined")?x:a),...g,children:l(s)?s(b):s})]});var w}function oe(n){const{value:o,onChange:i}=n,{app:a,shadow:s}=r(),[c,l]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{const e=document.createElement("style");return e.innerText='.\\!\\[position\\:relative\\]{position:relative!important}.\\[align-items\\:center\\]{align-items:center}.\\[background\\:transparent\\]{background:transparent}.\\[border\\:0\\]{border:0}.\\[bottom\\:20px\\]{bottom:20px}.\\[cursor\\:pointer\\]{cursor:pointer}.\\[display\\:flex\\]{display:flex}.\\[flex\\:1\\]{flex:1}.\\[font-family\\:inherit\\]{font-family:inherit}.\\[font-size\\:16px\\]{font-size:16px}.\\[font-size\\:18px\\]{font-size:18px}.\\[height\\:32px\\]{height:32px}.\\[height\\:40vh\\]{height:40vh}.\\[justify-content\\:center\\]{justify-content:center}.\\[margin-inline\\:auto\\]{margin-inline:auto}.\\[position\\:absolute\\]{position:absolute}.\\[width\\:100\\%\\]{width:100%}.\\[width\\:32px\\]{width:32px}.\\[width\\:60\\%\\]{width:60%}.disabled\\:\\[cursor\\:default\\]:disabled{cursor:default}.disabled\\:\\[opacity\\:20\\%\\]:disabled{opacity:20%}.\\[\\&\\~section\\:first-of-type\\]\\:\\[margin-top\\:16px\\]~section:first-of-type{margin-top:16px}.\\[\\&\\~section\\:last-of-type\\]\\:\\[margin-bottom\\:16px\\]~section:last-of-type{margin-bottom:16px}.reactEasyCrop_Container{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;user-select:none;touch-action:none;cursor:move;display:flex;justify-content:center;align-items:center}.reactEasyCrop_Image,.reactEasyCrop_Video{will-change:transform}.reactEasyCrop_Contain{max-width:100%;max-height:100%;margin:auto;position:absolute;top:0;bottom:0;left:0;right:0}.reactEasyCrop_Cover_Horizontal{width:100%;height:auto}.reactEasyCrop_Cover_Vertical{width:auto;height:100%}.reactEasyCrop_CropArea{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border:1px solid rgba(255,255,255,0.5);box-sizing:border-box;box-shadow:0 0 0 9999em;color:rgba(0,0,0,0.5);overflow:hidden}.reactEasyCrop_CropAreaRound{border-radius:50%}.reactEasyCrop_CropAreaGrid::before{content:"";box-sizing:border-box;position:absolute;border:1px solid rgba(255,255,255,0.5);top:0;bottom:0;left:33.33%;right:33.33%;border-top:0;border-bottom:0}.reactEasyCrop_CropAreaGrid::after{content:"";box-sizing:border-box;position:absolute;border:1px solid rgba(255,255,255,0.5);top:33.33%;bottom:33.33%;left:0;right:0;border-left:0;border-right:0}',s.appendChild(e),()=>{s.removeChild(e)}}),[]),(0,e.jsxs)(u.Space,{size:0,direction:"vertical",className:"avatar-upload",children:[(0,e.jsx)(ee,{zoomSlider:!0,rotationSlider:!0,cropperProps:{disableAutomaticStylesInjection:!0},children:(0,e.jsx)(u.Upload,{name:"avatar",maxCount:1,accept:"image/*",multiple:!1,showUploadList:!1,listType:"picture-circle",beforeUpload:e=>{const t=new FileReader;l(!0),t.addEventListener("load",(function(){i&&i(this.result),l(!1)})),t.readAsDataURL(e)},children:o?(0,e.jsx)("img",{src:o,className:"avatar-image",alt:"avatar"}):c?(0,e.jsx)(E.LoadingOutlined,{}):(0,e.jsx)(E.UploadOutlined,{})})}),(0,e.jsx)(ne,{width:256,footer:null,title:a.i18n("choose_avatar"),trigger:t=>(0,e.jsx)(u.Button,{type:"link",size:"small",onClick:t,className:"choose-avatar",children:a.i18n("choose")}),children:t=>(0,e.jsx)(te,{onChange:i,onClose:t})})]})}function re(){const[n]=u.Form.useForm(),{me:o,app:r,user:i,updateProfile:a}=v(),[s,c]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{n.setFieldsValue({mail:i.mail,name:i.name,avatar:i.avatar})}),[i.name,i.avatar,i.mail]),(0,e.jsxs)(u.Form,{form:n,name:"profile",onFinish:e=>{const t={};!function(e,t){if(!e)return;let n=0;if(e.forEach){const o=e.length;if(o<=0)return;for(;n<o&&!t(e[n],n);)n++}else{const o=Object.keys(e),r=o.length;if(r<=0)return;for(;n<r&&!t(e[o[n]],o[n]);)n++}}(e,((e,n)=>{"mail"!==n&&e&&i[n]!==e&&(t[n]=e)})),t.name||t.avatar?(c(!0),a(t).then((()=>{r.success("modify_success");const e=r.data(o.id);l(e)&&(r.data(o.id,"destory"),e())})).catch((e=>{r.error(e&&e.message?e.message:e)})).finally((()=>{c(!1)}))):r.warning("info_empty")},className:"form-wrapper",children:[(0,e.jsx)(u.Form.Item,{name:"avatar",children:(0,e.jsx)(oe,{})}),(0,e.jsx)(u.Form.Item,{name:"mail",children:(0,e.jsx)(u.Input,{disabled:!0})}),(0,e.jsx)(u.Form.Item,{name:"name",extra:r.i18n("name_rule"),rules:[{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")}],children:(0,e.jsx)(u.Input,{autoComplete:"off",placeholder:r.i18n("display_name")})}),(0,e.jsx)(u.Form.Item,{children:(0,e.jsx)(u.Button,{block:!0,type:"primary",htmlType:"submit",loading:s,children:r.i18n("modify")})})]})}function ie(n){const{mail:o,value:i,onChange:a}=n,{app:s}=r(),c=(0,t.useRef)(null),[l,p]=(0,t.useState)(0),[d,h]=(0,t.useState)(!1),[m,f]=(0,t.useState)(!1);return(0,t.useEffect)((()=>(l>0?c.current=setInterval((()=>{p((e=>e-1))}),1e3):f(!1),()=>{clearInterval(c.current)})),[l]),(0,e.jsxs)(u.Row,{children:[(0,e.jsx)(u.Col,{span:14,children:(0,e.jsx)(u.Input,{value:i,maxLength:6,minLength:6,autoComplete:"off",onChange:e=>{a&&a(e.target.value)},placeholder:s.i18n("verified_code")})}),(0,e.jsx)(u.Col,{offset:1,span:9,children:(0,e.jsx)(u.Button,{block:!0,type:"primary",loading:d,onClick:()=>{h(!0),s.fetch("circle/verification",{data:{mail:o}}).then((()=>{p(60),f(!0),s.success("mail_success")})).catch((e=>{s.error(e&&e.message?e.message:e)})).finally((()=>{h(!1)}))},disabled:m||!o||!/([\w-]+@[\w-]+\.[\w-]+)/.test(o),children:m?`${s.i18n("retry_send")}(${l}s)`:s.i18n("send_verified_code")})})]})}function ae(){const[n]=u.Form.useForm(),{me:o,app:r,register:i}=v(),[a,s]=(0,t.useState)(!1);return(0,e.jsxs)(u.Form,{form:n,name:"register",onFinish:e=>{s(!0),i(e).then((()=>{n.resetFields(),r.success("register_success");const e=r.data(o.id);l(e)?(r.data(o.id,"destory"),e()):setTimeout((()=>{r.fire(`${o.id}_route`,"profile")}),1e3)})).catch((e=>{r.error(e&&e.message?e.message:e)})).finally((()=>{s(!1)}))},className:"form-wrapper",children:[(0,e.jsx)(u.Form.Item,{name:"name",extra:r.i18n("name_rule"),rules:[{required:!0,message:r.i18n("name_placeholder")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")}],children:(0,e.jsx)(u.Input,{autoComplete:"off",placeholder:r.i18n("display_name")})}),(0,e.jsx)(u.Form.Item,{name:"mail",rules:[{required:!0,type:"email",message:r.i18n("mail_placeholder")}],children:(0,e.jsx)(u.Input,{autoComplete:"off",placeholder:r.i18n("mail")})}),(0,e.jsx)(u.Form.Item,{noStyle:!0,dependencies:["mail"],children:t=>(0,e.jsx)(u.Form.Item,{name:"code",rules:[{required:!0,len:6}],children:(0,e.jsx)(ie,{mail:t.getFieldValue("mail")})})}),(0,e.jsx)(u.Form.Item,{name:"pass",rules:[{required:!0,message:r.i18n("pass_placeholder")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")}],children:(0,e.jsx)(u.Input.Password,{autoComplete:"off",placeholder:r.i18n("pass")})}),(0,e.jsx)(u.Form.Item,{name:"password",dependencies:["pass"],rules:[{required:!0,message:r.i18n("pass_confirm_again")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")},({getFieldValue:e})=>({validator:(t,n)=>n&&e("pass")!==n?Promise.reject(new Error(r.i18n("pass_diff"))):Promise.resolve()})],children:(0,e.jsx)(u.Input.Password,{autoComplete:"off",placeholder:r.i18n("pass_confirm")})}),(0,e.jsx)(u.Form.Item,{children:(0,e.jsx)(u.Button,{block:!0,type:"primary",htmlType:"submit",loading:a,children:r.i18n("register")})})]})}function se(){const[n]=u.Form.useForm(),{me:o,app:r,resetPassowrd:i}=v(),[a,s]=(0,t.useState)(!1);return(0,e.jsxs)(u.Form,{form:n,name:"password",onFinish:e=>{s(!0),i(e).then((()=>{n.resetFields(),r.success("pass_success");const e=r.data(o.id);l(e)?(r.data(o.id,"destory"),e()):setTimeout((()=>{r.fire(`${o.id}_route`,"login")}),1e3)})).catch((e=>{r.error(e&&e.message?e.message:e)})).finally((()=>{s(!1)}))},className:"form-wrapper",children:[(0,e.jsx)(u.Form.Item,{name:"mail",rules:[{required:!0,type:"email",message:r.i18n("mail_placeholder")}],children:(0,e.jsx)(u.Input,{placeholder:r.i18n("mail"),autoComplete:"off"})}),(0,e.jsx)(u.Form.Item,{noStyle:!0,dependencies:["mail"],children:t=>(0,e.jsx)(u.Form.Item,{name:"code",rules:[{required:!0,len:6}],children:(0,e.jsx)(ie,{mail:t.getFieldValue("mail")})})}),(0,e.jsx)(u.Form.Item,{name:"password",rules:[{required:!0,message:r.i18n("new_pass_placeholder")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")}],children:(0,e.jsx)(u.Input.Password,{autoComplete:"off",placeholder:r.i18n("new_pass")})}),(0,e.jsx)(u.Form.Item,{name:"confirm",dependencies:["password"],rules:[{required:!0,message:r.i18n("new_pass_again")},{min:3,message:r.i18n("name_min")},{max:60,message:r.i18n("name_max")},({getFieldValue:e})=>({validator:(t,n)=>n&&e("password")!==n?Promise.reject(new Error(r.i18n("pass_diff"))):Promise.resolve()})],children:(0,e.jsx)(u.Input.Password,{autoComplete:"off",placeholder:r.i18n("new_pass_confirm")})}),(0,e.jsx)(u.Form.Item,{children:(0,e.jsx)(u.Button,{block:!0,type:"primary",htmlType:"submit",loading:a,children:r.i18n("reset_password")})})]})}function ce(){const{me:n,app:o,user:r}=v(),[i,a]=(0,t.useState)(""),s=r.is_logged_in?[{key:"profile",label:o.i18n("profile"),children:(0,e.jsx)(re,{})},{key:"feedback",label:o.i18n("my_feedback"),children:(0,e.jsx)(P,{})},{key:"order",label:o.i18n("my_order"),children:(0,e.jsx)(j,{})},{key:"donate",label:o.i18n("my_donate"),children:(0,e.jsx)(S,{})}]:[{key:"login",label:o.i18n("login"),children:(0,e.jsx)(O,{})},{key:"register",label:o.i18n("register"),children:(0,e.jsx)(ae,{})},{key:"password",label:o.i18n("reset_password"),children:(0,e.jsx)(se,{})}];return(0,t.useEffect)((()=>o.on(`${n.id}_route`,(e=>{a(e||"login")}))),[]),(0,t.useEffect)((()=>{s.find((e=>e.key===i))||a(s[0].key)}),[i,s.length]),(0,e.jsx)(u.Tabs,{items:s,activeKey:i,onChange:a})}function le(){const{me:n,app:o}=r();return(0,t.useEffect)((()=>{o.fire("display")}),[]),location.hash.indexOf("mid=account")>=0?(0,e.jsx)("div",{className:"outside-tab",children:(0,e.jsx)("div",{className:"inside-tab",children:(0,e.jsx)(ce,{})})}):(0,e.jsx)(g,{id:n.id,width:700,type:"modal",footer:null,className:"wrapper",maskClosable:!1,onChange:(e,t,r)=>{if(!e)return t?(o.fire(`${n.id}_route`,t,r),!0):void 0;t?l(r)?(o.data(n.id,r),o.fire(`${n.id}_route`,t)):o.fire(`${n.id}_route`,t,r):o.fire(`${n.id}_route`,"login")},onVisible:e=>{o.fire("scrollable",!e)},styles:{body:{padding:0}},children:(0,e.jsx)(ce,{})})}window.definePlugin("account",(function(t,n,r){let i=null;return{start(){i||(i=r.display.render((({root:i,shadow:a,container:s})=>({app:n,me:t,children:(0,e.jsx)(le,{}),provider:(0,e.jsx)(o.Provider,{value:{app:n,root:i,shadow:a,container:s,me:t,dependencies:r}})})),{style:".ant-space.avatar-upload {\n  display: flex;\n  align-items: center;\n}\n.ant-space.avatar-upload .anticon-upload {\n  font-size: 30px;\n}\n.avatar-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n.avatar-man {\n  margin-top: 8px;\n}\n.avatar-man .ant-avatar {\n  cursor: pointer;\n}\n.ant-btn.choose-avatar {\n  font-size: 12px;\n  padding: 0;\n  line-height: 1;\n  height: auto;\n}\n.ant-form .ant-form-item .ant-form-item-extra {\n  font-size: 12px;\n  opacity: 0.6;\n  margin-top: 3px;\n}\n\n.container {\n  user-select: none;\n}\n.container .ant-modal.wrapper .ant-modal-content {\n  padding-top: 3px;\n  min-height: 460px;\n}\n.container .form-wrapper {\n  max-width: 380px;\n  margin: 60px auto;\n}\n.container .ant-form-item:last-child {\n  margin-bottom: 0;\n}\n.container .ant-tabs-top > .ant-tabs-nav {\n  margin-bottom: 8px;\n}\n.container .ant-space.flex {\n  display: flex;\n  margin-bottom: 8px;\n  justify-content: space-between;\n}\n.container .table-cell {\n  max-width: 330px;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n}\n.outside-tab {\n  background: var(--canvas);\n  padding: 80px 0;\n}\n.outside-tab .inside-tab {\n  min-height: 80vh;\n  max-width: 1000px;\n  border-radius: 10px;\n  padding: 7px 20px;\n  margin: 0 auto;\n  background: var(--bg);\n}\n\n.ant-drawer.popup-toolbar {\n  height: auto;\n  bottom: auto;\n  left: auto;\n}\n.ant-drawer.popup-toolbar .ant-drawer-content-wrapper {\n  height: auto !important;\n  width: auto !important;\n  position: static !important;\n}\n.ant-drawer.popup-toolbar .ant-drawer-content {\n  flex-direction: row-reverse;\n  align-items: start;\n}\n.ant-drawer.popup-toolbar .ant-drawer-header-close-only {\n  padding: 16px;\n  border: 0;\n}\n.ant-drawer.popup-toolbar .ant-drawer-header-close-only .ant-drawer-close {\n  margin-right: 0;\n}\n\n.mobile .ant-drawer.popup-toolbar .ant-drawer-content-wrapper {\n  overflow: auto;\n  max-height: 100vh !important;\n  width: 100vw !important;\n}\n\n"}))},destory(){i&&(i(),i=null)}}}))})()})();