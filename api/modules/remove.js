(()=>{"use strict";function e(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function t(e,t){return!(!e||!e.tagName)&&e.tagName.toLowerCase()===t}function n(e){return e&&e.nodeType&&1===e.nodeType}function r(e,t,r){if(!e)return null;const i="circlereader_choose",o=document.createElement("style");function s(e){const t=e.target,o=e.fromElement||e.relatedTarget;n(o)&&o.classList.remove(i),r?!r(t)&&t.classList.add(i):t.classList.add(i)}function a(e){if(e.stopPropagation(),e.preventDefault(),!t)return;let n=e.target,i=n.parentElement;for(;i.childNodes.length<=1;)n=i,i=i.parentElement;r?!r(n)&&t(n):t(n)}return o.textContent=`\n    .${i}{\n      background:#ddd !important;\n      cursor:pointer !important;\n      outline:3px dashed #777 !important;\n    }';\n  `,e.appendChild(o),e.addEventListener("click",a),e.addEventListener("mouseover",s),function(){o.parentElement?.removeChild(o),e.removeEventListener("click",a),e.removeEventListener("mouseover",s),function(e,t){if(!e)return;let n=0;if(e.forEach){const r=e.length;if(r<=0)return;for(;n<r&&!t(e[n],n);)n++}else{const r=Object.keys(e),i=r.length;if(i<=0)return;for(;n<i&&!t(e[r[n]],r[n]);)n++}}(e.querySelectorAll(`.${i}`),(function(e){e.classList.remove(i)}))}}window.definePlugin("remove",(function(i){let o=null;return{onClick(e,t,n,r){!r.contains(t)&&this.onBusy(e)},onBusy(t){t.fire("toolbar_state",i.id,"inactive"),e(o,"Function")&&o(),o=null,t.field("busy",!1)},onScreenshotChange(e,t){t&&this.onBusy(e)},onPrintChange(e,t){t&&this.onBusy(e)},_run(e){e.field("busy",!0);let s=e.field("container");if(n(s)){const e=s.querySelector(".pages");n(e)&&(s=e)}e.fire("toolbar_state",i.id,"active"),o=r(s,(r=>{if(!r)return;const o=r.tagName.toLowerCase();e.fire(`${i.id}_after`,function(e){if(!n(e))return"";const r=[];for(;e;){const n=e.id;if(n){r.unshift(`#${n}`);break}const i=e.tagName.toLocaleLowerCase();if(t(e,"body")||t(e,"html")){r.unshift(i);break}let o=1,s=e.previousElementSibling;for(;s;)o++,s=s.previousElementSibling;r.unshift(`${i}:nth-child(${o})`),e=e.parentElement}return r.join(" > ")}(r)),r.classList.add("noise"),["img","pre"].includes(o)&&e.fire(`${i.id}_${o}`)}),(e=>e.classList.contains("page"))),function(e,t,n){e.get("alert").then((r=>{r?t&&t(!0):e.fire("notice",{duration:5,onClose:t,message:e.i18n("alert"),btnText:n||e.i18n("got_it")},(()=>{e.set("alert",!0)}))}))}(e)},onSelf(e){o?this.onBusy(e):(e.fire("busy"),setTimeout((()=>{this._run(e)}),100))}}}))})();