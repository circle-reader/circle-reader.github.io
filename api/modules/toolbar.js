(()=>{"use strict";var e={n:n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return e.d(o,{a:o}),o},d:(n,o)=>{for(var t in o)e.o(o,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:o[t]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=ReactJsxRuntime,o=React,t=(0,o.createContext)({}),r=Antd,a=classNames;var i=e.n(a);const l=AntDesignIcons;function s(e){const{id:o,value:t,label:a,color:s,active:c,loading:u,tooltip:p,onClick:d}=e,m=u?l.LoadingOutlined:l[t];return m?(0,n.jsx)(r.Tooltip,{placement:"right",title:p?a:null,children:(0,n.jsx)(m,{title:a,style:{color:s},onClick:d,className:i()(o,{active:c})})}):(0,n.jsx)(r.Tooltip,{placement:"right",title:p?a:null,children:(0,n.jsx)("span",{tabIndex:-1,title:a,style:{color:s},onClick:d,className:i()("anticon",o,{active:c}),dangerouslySetInnerHTML:{__html:t}})})}function c(e){const{access:o,className:t,style:r}=e;if(!o)return null;const a=Array.isArray(o)?o:[o];return a.includes("premium")?(0,n.jsx)("span",{className:i()("access",t),style:r,children:"ðŸ‘‘"}):a.includes("member")?(0,n.jsx)("span",{className:i()("access",t),style:r,children:"ðŸ’Ž"}):null}function u(){return(0,o.useContext)(t)}function p(e){const{me:n,app:o,root:t,shadow:r,container:a}=u();let i=!1;if(e){const n=Array.isArray(e)?e:[e];o.user.roles.includes("premium")?(n.includes("premium")||n.includes("member"))&&(i=!0):o.user.roles.includes("member")&&n.includes("member")&&(i=!0)}else i=!0;return{me:n,app:o,root:t,allow:i,shadow:r,container:a,onAllow:()=>!!i||(o.fire("subscribe"),!1)}}function d(e){const{id:o,loading:t,label:a,access:i}=e,{me:l,app:u,allow:d,onAllow:m}=p(i),f=()=>{t||(u.device.phone&&u.fire("toolbar_fold"),m&&(u.fire(o),u.record(`${l.id}_${o}`)))};return d?(0,n.jsxs)(r.Space,{size:4,onClick:f,children:[(0,n.jsx)(s,{...e}),a]}):(0,n.jsxs)(r.Space,{size:4,onClick:f,children:[(0,n.jsx)(s,{...e}),a,(0,n.jsx)(c,{access:i})]})}const m={1:(0,n.jsx)(l.SolutionOutlined,{}),5:(0,n.jsx)(l.FormOutlined,{}),10:(0,n.jsx)(l.ExportOutlined,{}),15:(0,n.jsx)(l.ProfileOutlined,{}),20:(0,n.jsx)(l.ApiOutlined,{}),25:(0,n.jsx)(l.CloudOutlined,{})};function f(e){const{data:o,index:t}=e;return(0,n.jsx)(r.Popover,{placement:"rightTop",rootClassName:"popover",content:(0,n.jsx)(r.Menu,{selectable:!1,items:o.map((e=>({key:e.id,title:e.label,label:(0,n.jsx)(d,{...e})})))}),children:m[t]})}function h(){const{app:e}=u(),[t,r]=(0,o.useState)(!1),a=()=>{r(!t),e.fire("toolbar_collapse",!t)};return(0,o.useEffect)((()=>e.on("toolbar_fold",(()=>{r(!1),e.fire("toolbar_collapse",!1)}))),[]),e.device.phone?(0,n.jsx)("div",{className:"items",children:t?(0,n.jsx)(l.DownOutlined,{className:"icon-mobile",onClick:a}):(0,n.jsx)(l.MenuOutlined,{className:"icon-mobile",onClick:a})}):null}function v(e){const{id:o,loading:t,access:a,tooltip:i}=e,{me:l,app:u,allow:d,onAllow:m}=p(a),f=()=>{t||(u.device.phone&&u.fire("toolbar_fold"),m()&&(u.fire(o),u.record(`${l.id}_${o}`)))};return d?(0,n.jsx)(s,{...e,tooltip:i,onClick:f}):(0,n.jsx)(r.Badge,{count:(0,n.jsx)(c,{access:a}),children:(0,n.jsx)(s,{...e,tooltip:i,onClick:f})})}function b(e,n){if(!e)return;let o=0;if(e.forEach){const t=e.length;if(t<=0)return;for(;o<t&&!n(e[o],o);)o++}else{const t=Object.keys(e),r=t.length;if(r<=0)return;for(;o<r&&!n(e[t[o]],t[o]);)o++}}let g=[];let x=null;function y(e,n){x&&clearTimeout(x),x=setTimeout((()=>{!function(e,n){let o=!1;const t={...e};g.forEach((({id:e,state:n,reverse:r})=>{(Array.isArray(e)?e:[[e,n]]).forEach((e=>{const[n,a]=e;if(r)b(t,((e,r)=>{e.id!==n&&(["active","inactive"].includes(a)?t[r].active="active"===a:["loading","loaded"].includes(a)?t[r].loading="loading"===a:["visible","hidden"].includes(a)&&(o||(o=!0),t[r].hidden="hidden"===a))}));else{if(!t[n])return;["active","inactive"].includes(a)?t[n].active="active"===a:["loading","loaded"].includes(a)?t[n].loading="loading"===a:["visible","hidden"].includes(a)&&(o||(o=!0),t[n].hidden="hidden"===a)}}))})),n(t,o),g=[]}(e,n),g.length>0&&y(e,n)}),100)}function j(e){return Array.isArray(e)?e.sort(((e,n)=>(e.priority||0)-(n.priority||0))):[]}function w(e){const n=[];b(e,((e,o)=>{e.checked&&n.push({...e,id:o})}));const o={data:[],group:{}};return b(function(e,n){let o={};return j(e).forEach((function(e){const t=n(e),r=void 0!==t?t:"0";!o[r]&&(o[r]=[]),o[r].push(e)})),o}(j(n),(e=>e.group)),((e,n)=>{const t=e.filter((e=>!e.hidden));t.length<=0||("0"===n?b(t,(e=>{o.data.push(e)})):o.group[n]=t)})),o}function k(e,n){return Object.prototype.toString.call(e)===`[object ${n}]`}function E(e){return k(e,"Undefined")}function _(e){return k(e,"String")}function O(e){return e&&e.nodeType&&1===e.nodeType}function S(e){return k(e,"Function")}function C(e){const{id:n,disabled:t,defaultValue:r,fieldToListen:a}=e,{app:i,me:l,container:s}=u(),[c,p]=(0,o.useState)(r),d=()=>{t||i.option(n).then((e=>{!E(e)&&p(e)}))};return(0,o.useEffect)((()=>i.on("tab_activated",(e=>{e&&d()}))),[]),(0,o.useEffect)((()=>{d();let e="";e=a||(n&&"option"!==n?"display"===n?`${l.id}_display_${i.colorScheme.value?i.colorScheme.value+"_":""}option`:`${n}_option`:`${l.id}_option`);const o=[];return o.push(i.on(e,d)),o.push(i.on("color_scheme",d)),()=>{o.forEach((e=>{e()}))}}),[n]),{me:l,app:i,value:c,refetch:d,setValue:p,onChange:(e,o)=>{t||E(e)||i.option(n,e).then((()=>{p(e),S(o)&&o()})).catch((e=>{console.error(e),S(o)&&o(e.message)}))},container:s}}function T(){const{value:e,refetch:n}=function(e){const{id:n,table:t="option",disabled:r,defaultValue:a}=e,{app:i,me:l,container:s}=u(),[c,p]=(0,o.useState)(a),d=()=>{r||i.get(n,t).then((e=>{!E(e)&&p(e)}))};return(0,o.useEffect)(d,[n]),{me:l,app:i,value:c,refetch:d,setValue:p,onChange:(e,o)=>{r||E(e)||(e!==a?i.set(n,e,t).then((()=>{p(e),S(o)&&o()})).catch((e=>{console.error(e),S(o)&&o(e.message)})):i.remove(n,t).then((()=>{p(e),S(o)&&o()})).catch((e=>{console.error(e),S(o)&&o(e.message)})))},container:s}}({id:"option",defaultValue:{unfold:!1}}),{me:t,app:r,refetch:a,setValue:i,value:l,onChange:s}=C({defaultValue:{}});return(0,o.useEffect)((()=>r.on(`${t.id}_state`,((e,n,o)=>{e&&function(e,n,o){g.push(e),Object.keys(n).length<=0||y(n,o)}({id:e,state:n,reverse:o},l,((e,n)=>{if(n){const n={};Object.keys(e).forEach((o=>{const{label:t,...r}=e[o];n[o]=r})),s(n)}else i(e)}))}))),[l]),(0,o.useEffect)((()=>{const e=[];return e.push(r.on(`${t.id}_dragend`,a)),e.push(r.on(`${t.id}_option`,n)),()=>{e.forEach((e=>{e()}))}}),[]),{unfold:!!e.unfold,data:w(l)}}function $(){const{data:e,unfold:t}=T();return(0,n.jsxs)(n.Fragment,{children:[e.data.length>0&&(0,n.jsx)("div",{className:"items",children:e.data.map((e=>(0,o.createElement)(v,{...e,key:e.id,tooltip:!0})))}),(0,n.jsx)("div",{className:"items",children:t?Object.keys(e.group).map((n=>{const t=e.group[n];return t.length<=0?null:t.map((e=>(0,o.createElement)(v,{...e,key:e.id,tooltip:!0})))})):Object.keys(e.group).map((t=>{const r=e.group[t];return r.length<=2?r.map((e=>(0,o.createElement)(v,{...e,key:e.id,tooltip:!0}))):(0,n.jsx)(f,{index:t,data:r},t)}))}),(0,n.jsx)(h,{})]})}function z(){const e=(0,o.useRef)(null),n=(0,o.useRef)(null),t=(0,o.useRef)(null),[r,a]=(0,o.useState)(!1),[i,l]=(0,o.useState)(!1),[s,c]=(0,o.useState)(!1),{me:u,app:p,container:d,value:m}=C({id:"display",defaultValue:{itemspace:"10px",groupspace:"10px",autohide:!1}}),f=()=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{const e=p.field("container");if(!e||!O(e))return void l(!1);const n=e.querySelector(".pages");n&&O(n)?l((window.innerWidth-n.clientWidth)/2<40):l(!1)}),1e3)};return(0,o.useEffect)((()=>{d.style.setProperty("--itemspace",_(m.itemspace)?m.itemspace:`${m.itemspace}px`),d.style.setProperty("--groupspace",_(m.groupspace)?m.groupspace:`${m.groupspace}px`)}),[m.itemspace,m.groupspace]),(0,o.useEffect)((()=>{const e=[];return e.push(p.on(`render_display_${p.colorScheme.value?p.colorScheme.value+"_":""}option`,((e,n)=>{"paper"===n&&c(!e)}))),e.push(p.on("fullscreen_change",(e=>{d.classList[e?"add":"remove"]("fullscreen")}))),e.push(p.on("screenshot_change",(e=>{e?d.style.display="none":d.style.removeProperty("display")}))),e.push(p.on("toolbar_collapse",(e=>{d.classList[e?"add":"remove"]("collapse"),p.fire("backtop_visible",!e)}))),()=>{e.forEach((e=>{e()}))}}),[]),(0,o.useEffect)((()=>{function e(){n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{p.device.phone||f()}),1e3)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,o.useEffect)((()=>{p.field({toolbar:d})}),[d]),(0,o.useEffect)((()=>{a(m.autohide)}),[m.autohide]),(0,o.useEffect)((()=>{(()=>{const e=p.field("container");c(O(e)&&!e.classList.contains("paper"))})(),f(),p.fire("display"),p.fire(`${u.id}_done`)}),[]),{hide:r,float:i,onMouseEnter:()=>{m.autohide&&(e.current&&clearTimeout(e.current),a(!1))},onMouseLeave:()=>{m.autohide&&(e.current&&clearTimeout(e.current),e.current=setTimeout((()=>{a(!0)}),2e3))},shadow:!p.device.phone&&s}}function A(e){const{children:o}=e,{hide:t,float:r,shadow:a,onMouseEnter:l,onMouseLeave:s}=z();return(0,n.jsx)("div",{onMouseEnter:l,onMouseLeave:s,className:i()("toolbar",{hide:t,float:r,shadow:a}),children:o})}function N(){return(0,n.jsx)(A,{children:(0,n.jsx)($,{})})}window.definePlugin("toolbar",(function(e,o,r){let a=null;return{start(){a||(a=r.display.render((({root:a,shadow:i,container:l})=>({app:o,me:e,children:(0,n.jsx)(N,{}),provider:(0,n.jsx)(t.Provider,{value:{app:o,root:a,shadow:i,container:l,me:e,dependencies:r}})})),{style:".ant-popover.popover .ant-popover-inner {\n  padding: 0;\n  overflow: hidden;\n  border-radius: 6px;\n}\n.ant-popover.popover .ant-popover-inner .ant-menu {\n  border: 0;\n  color: var(--color);\n  background: var(--bg);\n}\n.ant-popover.popover .ant-popover-inner .ant-menu .ant-menu-item {\n  padding: 0;\n  height: 30px;\n  line-height: 30px;\n  border-radius: 3px;\n}\n.ant-popover.popover .ant-popover-inner .ant-menu .ant-menu-item .ant-space {\n  display: flex;\n  padding-left: 10px;\n  padding-right: 10px;\n}\n.ant-popover.popover .ant-popover-inner .ant-menu .ant-menu-item .anticon {\n  font-size: inherit;\n}\n\n.container {\n  --itemspace: 10px;\n  --groupspace: 10px;\n}\n.access {\n  pointer-events: none;\n}\n.toolbar {\n  z-index: 10;\n  position: fixed;\n  overflow: auto;\n  top: var(--margin);\n  color: var(--color);\n  transition: all 300ms;\n  font-weight: var(--weight);\n  font-size: calc(var(--size) + 4px);\n  max-height: calc(100vh - var(--margin) - 20px);\n  right: calc((100vw - var(--width)) / 2 + var(--offsetright) / 2 - var(--size) - 16px);\n  scrollbar-width: none;\n}\n.toolbar .items {\n  margin-bottom: var(--groupspace);\n}\n.toolbar .ant-badge {\n  display: block;\n  color: inherit;\n  font-size: inherit;\n}\n.toolbar .ant-badge .ant-scroll-number-custom-component {\n  font-size: 12px;\n  top: auto;\n  bottom: 0;\n  transform: none;\n}\n.toolbar .anticon {\n  display: block;\n  cursor: pointer;\n  color: var(--color);\n  opacity: 0.4;\n  margin-bottom: var(--itemspace);\n}\n.toolbar .anticon.active,\n.toolbar .anticon:hover {\n  opacity: 1;\n}\n.toolbar .anticon:focus {\n  outline: 0;\n}\n.toolbar.hide {\n  opacity: 0;\n}\n.toolbar::-webkit-scrollbar {\n  width: 0;\n}\n.toolbar.shadow {\n  background: var(--bg);\n  padding: 6px 7px 0px;\n  border-radius: 6px;\n  box-shadow: 0 2px 10px var(--canvas);\n  right: calc((100vw - var(--width)) / 2 + var(--offsetright) / 2 - var(--size) - 42px);\n}\n.toolbar.float {\n  top: 20px;\n  right: 20px;\n  max-height: 94vh;\n}\n.mobile .toolbar {\n  top: auto;\n  right: 18px;\n  bottom: 20px;\n  font-size: calc(var(--size) - 4px);\n}\n.mobile .toolbar .items {\n  margin-bottom: 0;\n}\n.mobile .toolbar .anticon {\n  display: none;\n  opacity: 0.8;\n  margin-bottom: 0;\n  margin-top: var(--itemspace);\n  padding: 10px;\n  border-radius: 50%;\n  background-color: var(--color);\n}\n.mobile .toolbar .anticon svg {\n  fill: var(--canvas);\n  --darkreader-inline-fill: var(--canvas) !important;\n}\n.mobile .toolbar .anticon.exit,\n.mobile .toolbar .anticon.icon-mobile {\n  display: block;\n}\n.mobile.collapse .toolbar .anticon {\n  display: block;\n}\n.mobile.collapse .toolbar .items {\n  margin-top: var(--groupspace);\n}\n@media screen and (max-width: 1000px) {\n  .toolbar {\n    top: 20px;\n    right: 20px;\n    max-height: 94vh;\n  }\n}\n@media print {\n  .container {\n    display: none;\n  }\n}\n\n"}))},destory(){a&&(a(),a=null)}}}))})();